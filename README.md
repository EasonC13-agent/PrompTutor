# Chat Collector for Research

ä¸€å€‹é–‹æºçš„ç€è¦½å™¨æ“´å……åŠŸèƒ½ï¼Œè®“å­¸ç”Ÿå¯ä»¥é¸æ“‡æ€§åœ°å°‡ AI èŠå¤©è¨˜éŒ„åˆ†äº«çµ¦ç ”ç©¶äººå“¡ï¼Œç”¨æ–¼æ•™è‚²ç ”ç©¶åˆ†æã€‚

## å°ˆæ¡ˆç‹€æ…‹

**é–‹å§‹æ—¥æœŸ**: 2026-02-06
**ç›®å‰éšæ®µ**: MVP é–‹ç™¼ä¸­

### å·²å®Œæˆ âœ…

- [x] Chrome Extension éª¨æ¶ (Manifest V3)
- [x] API æ””æˆªå™¨ (fetch interception for ChatGPT/Claude)
- [x] DOM fallback adapter æ¶æ§‹
- [x] Popup UI (ä½¿ç”¨æ¢æ¬¾ â†’ Google ç™»å…¥ â†’ ä¸»ç•«é¢)
- [x] Backend API (Express + PostgreSQL)
- [x] Firebase Auth æ•´åˆ (Google ç™»å…¥)
- [x] ä½¿ç”¨è€…åŒæ„æµç¨‹ (Terms of Service)
- [x] è³‡æ–™åˆªé™¤åŠŸèƒ½ (GDPR compliance)
- [x] æœ¬åœ° PostgreSQL è¨­å®š

### é€²è¡Œä¸­ ğŸ”„

- [ ] Ubuntu é›™ä¸»æ©Ÿ PostgreSQL replication è¨­å®š
- [ ] Mac Mini ä½œç‚ºç¬¬ä¸‰å€‹ read replica
- [ ] Extension å¯¦éš›æ¸¬è©¦

### å¾…é–‹ç™¼ ğŸ“‹

- [ ] è³‡æ–™åŒ¿ååŒ–è™•ç†
- [ ] Admin dashboard (æŸ¥çœ‹çµ±è¨ˆ)
- [ ] è³‡æ–™åŒ¯å‡ºåŠŸèƒ½ (CSV/JSON for researchers)
- [ ] Chrome Web Store ä¸Šæ¶
- [ ] æ›´å¤šå¹³å°æ”¯æ´ (Gemini, Perplexity)

## æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Chrome Extension                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Content     â”‚  â”‚ Background  â”‚  â”‚ Popup UI        â”‚  â”‚
â”‚  â”‚ Scripts     â”‚  â”‚ Worker      â”‚  â”‚ (Terms/Login/   â”‚  â”‚
â”‚  â”‚ (API æ””æˆª)  â”‚  â”‚ (Sync)      â”‚  â”‚  Dashboard)     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ HTTPS + Firebase Auth
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Backend API (Express)                  â”‚
â”‚  POST /api/consent    - è¨˜éŒ„åŒæ„                         â”‚
â”‚  POST /api/chats      - ä¸Šå‚³èŠå¤©è¨˜éŒ„                     â”‚
â”‚  GET  /api/my-chats   - æŸ¥çœ‹è‡ªå·±çš„è³‡æ–™                   â”‚
â”‚  DELETE /api/my-chats - åˆªé™¤è‡ªå·±çš„è³‡æ–™                   â”‚
â”‚  GET  /api/admin/*    - Admin å°ˆç”¨ endpoints            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PostgreSQL (Replicated)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Ubuntu 1      â”‚  â”‚ Ubuntu 2      â”‚  â”‚ Mac Mini    â”‚  â”‚
â”‚  â”‚ (Primary/     â”‚â†’ â”‚ (Read         â”‚â†’ â”‚ (Read       â”‚  â”‚
â”‚  â”‚  Write)       â”‚  â”‚  Replica)     â”‚  â”‚  Replica)   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ç›®éŒ„çµæ§‹

```
chat-collector/
â”œâ”€â”€ manifest.json              # Chrome Extension manifest
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ background/index.js    # Service worker
â”‚   â”œâ”€â”€ content/
â”‚   â”‚   â”œâ”€â”€ inject.js          # Injector script
â”‚   â”‚   â””â”€â”€ interceptor.js     # API interceptor
â”‚   â”œâ”€â”€ popup/
â”‚   â”‚   â”œâ”€â”€ index.html         # Popup UI
â”‚   â”‚   â””â”€â”€ popup.js           # Popup logic
â”‚   â””â”€â”€ adapters/
â”‚       â”œâ”€â”€ chatgpt/index.js   # ChatGPT adapter
â”‚       â””â”€â”€ claude/index.js    # Claude adapter
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ index.js               # Express server
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ .env.example
â”‚   â””â”€â”€ scripts/
â”‚       â””â”€â”€ init-db.js         # Database schema
â”œâ”€â”€ icons/                     # Extension icons
â””â”€â”€ README.md
```

## ç’°å¢ƒè®Šæ•¸

```env
# Server
PORT=3000
NODE_ENV=development

# PostgreSQL
DB_HOST=localhost
DB_PORT=5432
DB_NAME=chat_collector
DB_USER=postgres
DB_PASSWORD=

# Firebase Admin SDK
FIREBASE_PROJECT_ID=
FIREBASE_CLIENT_EMAIL=
FIREBASE_PRIVATE_KEY=

# Admin emails (comma-separated)
ADMIN_EMAILS=admin@example.com
```

## é–‹ç™¼

### å®‰è£ Backend

```bash
cd backend
npm install
cp .env.example .env
# ç·¨è¼¯ .env å¡«å…¥è¨­å®š
npm run db:init
npm run dev
```

### è¼‰å…¥ Extension

1. é–‹å•Ÿ `chrome://extensions`
2. å•Ÿç”¨ Developer mode
3. é»æ“Š "Load unpacked"
4. é¸æ“‡ `chat-collector` è³‡æ–™å¤¾

## ä½¿ç”¨æ¢æ¬¾é‡é»

- ä¸Šå‚³çš„è³‡æ–™å°‡**å®Œå…¨åŒ¿ååŒ–**è™•ç†
- åªä¸Šå‚³ä½¿ç”¨è€…**é¸æ“‡çš„èŠå¤© session**
- è³‡æ–™åƒ…ç”¨æ–¼**æ•™è‚²ç ”ç©¶ç”¨é€”**
- ä½¿ç”¨è€…å¯ä»¥éš¨æ™‚**æŸ¥çœ‹ä¸¦åˆªé™¤**æ‰€æœ‰è³‡æ–™

## æ”¯æ´å¹³å°

| å¹³å° | API æ””æˆª | DOM Fallback | ç‹€æ…‹ |
|------|---------|--------------|------|
| ChatGPT | âœ… | âœ… | é–‹ç™¼ä¸­ |
| Claude | âœ… | âœ… | é–‹ç™¼ä¸­ |
| Gemini | âŒ | âŒ | è¨ˆç•«ä¸­ |
| Perplexity | âŒ | âŒ | è¨ˆç•«ä¸­ |

## License

MIT
